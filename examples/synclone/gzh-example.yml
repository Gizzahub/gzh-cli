# gzh.yml - Organization Repository Management Configuration
# =========================================================
# This file is automatically generated and maintained by gz synclone
# It tracks all repositories in an organization directory and their sync status
#
# Location: <organization-directory>/gzh.yml
# Example: ~/repos/github/ScriptonBasestar/gzh.yml
#
# DO NOT EDIT MANUALLY - This file is managed by gz synclone
# Manual changes may be overwritten during the next sync operation

# Configuration version for compatibility checking
version: "1.0.0"

# Timestamps for tracking
created_at: "2025-01-25T10:30:00Z"      # When this organization was first cloned
last_synced: "2025-01-25T14:45:30Z"     # Last successful sync operation
last_modified: "2025-01-25T14:45:30Z"   # Last time this file was updated

# Organization Information
# -----------------------
# Metadata about the organization/group being managed
organization:
  name: "ScriptonBasestar"              # Organization/group name
  provider: "github"                    # Git provider: github, gitlab, gitea, gogs
  url: "https://github.com/ScriptonBasestar"  # Organization URL
  api_url: ""                          # Custom API URL (for self-hosted instances)
  description: "Scripton Basestar's GitHub Organization"

  # Organization statistics
  stats:
    total_repos: 45                    # Total repositories in organization
    public_repos: 30                   # Number of public repositories
    private_repos: 15                  # Number of private repositories

# Synchronization Configuration
# ----------------------------
# Settings used for cloning and syncing this organization
sync:
  # Clone settings
  strategy: "reset"                    # Sync strategy: reset, pull, fetch
  protocol: "ssh"                      # Protocol: https, ssh
  default_branch: "main"               # Default branch name
  depth: 0                            # Clone depth (0 = full history)
  bare: false                         # Whether to use bare repositories

  # Directory structure
  clone_dir: "~/work/scripton"        # Base directory for this organization
  flatten: false                      # Whether to flatten directory structure

  # Sync mode configuration
  sync_mode:
    cleanup_orphans: true             # Remove untracked directories
    conflict_resolution: "remote-overwrite"  # How to handle conflicts

  # Sync schedule (for reference)
  schedule:
    auto_sync: false                  # Whether auto-sync is enabled
    interval: "6h"                    # Sync interval
    last_scheduled: ""                # Last scheduled sync

# Repository Manifest
# ------------------
# Complete list of repositories managed in this organization
repositories:
  # Active development repository
  - name: "gzh-manager-go"
    path: "gzh-manager-go"            # Local directory name
    url: "git@github.com:ScriptonBasestar/gzh-manager-go.git"
    clone_url: "https://github.com/ScriptonBasestar/gzh-manager-go.git"
    branch: "main"                    # Current branch
    default_branch: "main"            # Repository default branch
    last_commit: "cf69ab7c2d1e"       # Last known commit (short SHA)
    last_synced: "2025-01-25T14:45:30Z"
    size: "45MB"                      # Repository size
    language: "Go"                    # Primary language
    topics: ["cli", "devops", "golang"]
    visibility: "public"              # public, private
    status: "active"                  # active, archived, disabled

  # Library repository with custom branch
  - name: "go-utils"
    path: "go-utils"
    url: "git@github.com:ScriptonBasestar/go-utils.git"
    clone_url: "https://github.com/ScriptonBasestar/go-utils.git"
    branch: "develop"                 # Using develop branch
    default_branch: "main"
    last_commit: "def456ghi789"
    last_synced: "2025-01-25T14:45:30Z"
    size: "12MB"
    language: "Go"
    topics: ["golang", "utilities", "library"]
    visibility: "public"
    status: "active"

  # Archived repository (kept for reference)
  - name: "legacy-api"
    path: "legacy-api"
    url: "git@github.com:ScriptonBasestar/legacy-api.git"
    clone_url: "https://github.com/ScriptonBasestar/legacy-api.git"
    branch: "master"
    default_branch: "master"
    last_commit: "789abcdef012"
    last_synced: "2025-01-25T14:45:30Z"
    size: "120MB"
    language: "Java"
    topics: ["java", "spring", "legacy"]
    visibility: "private"
    status: "archived"               # This repo is archived

  # Failed sync repository
  - name: "experimental-ml"
    path: "experimental-ml"
    url: "git@github.com:ScriptonBasestar/experimental-ml.git"
    clone_url: "https://github.com/ScriptonBasestar/experimental-ml.git"
    branch: "main"
    default_branch: "main"
    last_commit: ""
    last_synced: "2025-01-25T14:30:00Z"
    last_error: "Authentication failed"  # Error from last sync
    retry_count: 3                      # Number of retry attempts
    size: "0MB"
    language: "Python"
    topics: ["machine-learning", "python"]
    visibility: "private"
    status: "error"                    # Sync failed

# Excluded Repositories
# --------------------
# Repositories that were excluded by filters
excluded:
  - name: "test-repo-1"
    reason: "Matched exclude pattern: ^test-.*"

  - name: "example-archive"
    reason: "Matched exclude pattern: .*-archive$"

  - name: ".github"
    reason: "Matched exclude pattern: ^\\."

  - name: "fork-external-lib"
    reason: "Excluded by user configuration"

# Applied Filters
# --------------
# Filters that were applied during synclone
filters:
  visibility: "all"                   # all, public, private
  include_pattern: ""                 # Regex pattern for inclusion
  exclude_patterns:                   # Exclusion patterns
    - "^test-.*"
    - ".*-archive$"
    - "^\\."
    - "^fork-.*"

  # Additional filter criteria
  min_size: ""                        # Minimum repository size
  max_size: ""                        # Maximum repository size
  languages: []                       # Filter by programming languages
  topics: []                          # Filter by topics/tags

# Synchronization Statistics
# -------------------------
stats:
  # Repository counts
  total_repos: 45                     # Total in organization
  synced_repos: 41                    # Successfully synced
  excluded_repos: 3                   # Excluded by filters
  failed_repos: 1                     # Failed to sync

  # Size information
  total_size: "1.8GB"                 # Total disk usage
  largest_repo: "legacy-api"          # Largest repository

  # Timing information
  last_sync_duration: "2m35s"         # Duration of last sync
  average_sync_time: "3m10s"          # Average sync duration

  # Operation counts
  total_syncs: 15                     # Total sync operations
  successful_syncs: 14                # Successful syncs
  failed_syncs: 1                     # Failed syncs

# Authentication Configuration
# ---------------------------
# Sanitized authentication information
auth:
  method: "token"                     # Authentication method: token, ssh
  token_var: "GITHUB_TOKEN"           # Environment variable used
  token_source: "environment"         # Token source: environment, config, keychain
  ssh_key: "~/.ssh/github_rsa"        # SSH key path
  ssh_agent: true                     # Whether SSH agent is used
  last_validated: "2025-01-25T14:45:30Z"  # Last auth validation

# Custom Metadata
# --------------
# User-defined metadata for organization
metadata:
  # Team/project information
  team: "backend"
  project: "microservices"
  environment: "development"
  owner: "ScriptonBasestar"

  # Categorization
  tags:
    - "golang"
    - "kubernetes"
    - "microservices"
    - "devops"

  # Custom fields
  cost_center: "engineering"
  compliance: "soc2"
  backup_policy: "daily"

# Sync History
# -----------
# Recent sync operations (keep last 5)
history:
  - timestamp: "2025-01-25T14:45:30Z"
    operation: "sync"
    status: "success"
    duration: "2m35s"
    synced: 41
    failed: 1

  - timestamp: "2025-01-25T08:00:00Z"
    operation: "sync"
    status: "success"
    duration: "3m12s"
    synced: 41
    failed: 0

  - timestamp: "2025-01-24T20:00:00Z"
    operation: "clone"
    status: "partial"
    duration: "5m45s"
    synced: 40
    failed: 2

  - timestamp: "2025-01-24T14:30:00Z"
    operation: "sync"
    status: "success"
    duration: "2m58s"
    synced: 40
    failed: 0

  - timestamp: "2025-01-24T08:00:00Z"
    operation: "sync"
    status: "success"
    duration: "3m05s"
    synced: 40
    failed: 0

# Health Check
# -----------
# Organization health status
health:
  status: "warning"                   # overall health: healthy, warning, error
  issues:
    - type: "sync_failure"
      repo: "experimental-ml"
      message: "Failed to sync after 3 attempts"
      since: "2025-01-25T14:30:00Z"

  last_check: "2025-01-25T14:45:30Z"
